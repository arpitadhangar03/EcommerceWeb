{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="container2">
  <div id="carouselExampleInterval" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active" data-bs-interval="3000">
        <img src="https://i.pinimg.com/1200x/79/f6/6c/79f66c1dea34bff1d5cd8798d75d3316.jpg" class="d-block w-100"
          alt="...">
      </div>
      <div class="carousel-item" data-bs-interval="2000">
        <img src="https://i.pinimg.com/1200x/e2/02/cc/e202cc42f69f6b2512d2d24f3dd93aed.jpg" class="d-block w-100"
          alt="...">
      </div>
      <div class="carousel-item">
        <img src="https://i.pinimg.com/1200x/4f/b9/49/4fb949c8a88cbef6991196e6b9d14ed1.jpg" class="d-block w-100"
          alt="...">
      </div>
      <div class="carousel-item">
        <img src="https://i.pinimg.com/1200x/8d/69/43/8d69436f5c78995241d147b62a78b2fa.jpg" class="d-block w-100"
          alt="...">
      </div>
      <div class="carousel-item">
        <img src="https://i.pinimg.com/1200x/33/6e/b9/336eb91315724ffd3bb7b50168e52345.jpg" class="d-block w-100"
          alt="...">
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
</div>

<div class="celebapp">
  <h1>Celeb Approved Brands</h1>
  <div class="brands">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR65F5DOZX1LAnUevhCtnazLE0i2AS-BI5clg&s" alt="">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQGR3i-4Vce4INg8aJ7beILfCQdZj_-a98OrA&s" alt="">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSBAwN68FMXSA5mEjHZX_t_mW0rJ2OQGXH5mQ&s" alt="">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRVALu3Gkk-SleylcDlM1tbIUEKQD_IYT_C3w&s" alt="">
  </div><br>
  <div class="brands2">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT2r_kN5kPmacNUUqoa_o80_VRPQzBeeoxlNQ&s" alt="">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRofDsBN5cCGjD43WrKeI1zI02znO1WepOQyQ&s" alt="">
    <img src="https://www.worldfashionexchange.com/blog/wp-content/uploads/2024/01/PRADA.webp" alt="prada">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTiDq7kFn4hJVtIFFvEQKn9JLXKYYW1UDVtiw&s" alt="dior">
  </div>
</div>
<!-- Trending Clothes (Reels-style) -->
<section class="trend-reels">
  <div class="reels-head">
    <h2>Trending Clothes</h2>
    <a href="#" class="view-all">View All</a>
  </div>

  <div class="reels-wrap">
    <!-- Reel Card 1 -->

    <div class="reel-card">
      <video autoplay muted loop>
        <source src="{% static 'products\video\reell.mp4' %}" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </div>



    <!-- Reel Card 2 (GIF ok too) -->
    <a href="/women/tops_w/" class="reel-card">
      <img src="https://i.pinimg.com/1200x/38/61/74/38617479b41974e631739a2e07bace07.jpg" alt="Trend 2">
      <div class="reel-overlay">
        <span class="badge">Hot</span>
        <div class="reel-meta">
          <p>Minimal Fits</p>
        </div>
      </div>
    </a>

    <!-- Reel Card 3 -->
    <a href="#" class="reel-card">
      <img src="https://i.pinimg.com/736x/c3/c4/66/c3c466317d2d027729708452651a8718.jpg" alt="Trend 3">
      <div class="reel-overlay">
        <span class="badge">Sale</span>
        <div class="reel-meta">
          <p>Monochrome Edit</p>
        </div>
      </div>
    </a>

    <!-- Add more cards as needed -->
  </div>
</section>

<div class="wrap">
  <div class="rec-card">
    <!-- left content -->
    <div class="card-content">
      <div class="eyebrow">See personalized</div>
      <h1>Recommendations made for you</h1>
      <p class="lead">Sign in to get curated picks â€” elegant offers, classy deals, and styles that match your taste.</p>
      <div class="cta-row">
        <a href="{% url 'accounts:login' %}"><button class="btn-sign">Sign in</button></a>
        <a class="small-link" href="{% url 'accounts:register' %}">New customer? Start here</a>
      </div>
      <div class="features">
        <div class="feature">Trending Picks</div>
        <div class="feature">Exclusive Offers</div>
        <div class="feature">Elegant Styles</div>
      </div>
    </div>
  </div>
</div>
<!-- Floating Chat Icon -->
<!-- Floating Chat Icon -->
<div id="chat-icon" style="
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 60px;
  height: 60px;
  background: linear-gradient(135deg, #bfa46f, #d1bc6f);
  border-radius: 50%;
  box-shadow: 0 4px 12px rgba(191,164,111,0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  z-index: 1000;
  color: #4a3a1e;
  font-size: 32px;
  user-select: none;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
">
  ðŸ’¬
</div>

<!-- Chat Box Popup -->
<div id="chat-popup" style="
  display: none; /* Initially hidden */
  position: fixed;
  bottom: 90px;
  right: 20px;
  width: 350px;
  height: 480px;
  background: #2d2a25;  /* subtle dark brown */
  border-radius: 20px;
  box-shadow: 0 10px 30px rgba(191,164,111,0.4);
  border: 2px solid #d1bc6f; /* lighter matte gold */
  z-index: 1000;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  color: #f1e6c9; /* soft cream - readable on dark */
">

  <!-- Header with Drag Handle and Close Button -->
  <div id="chat-popup-header" style="
    background: #4a3a1e;
    color: #d1bc6f;
    cursor: move;
    padding: 15px 24px;
    font-weight: 700;
    font-size: 1.2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  ">
    Chat Support
    <button id="close-chat" title="Close Chat" style="
      background: transparent;
      border: none;
      color: #d1bc6f;
      font-size: 28px;
      cursor: pointer;
      line-height: 1;
      font-weight: 900;
      user-select: none;
      transition: color 0.3s;
    " onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#d1bc6f'">&times;</button>
  </div>

  <!-- Chat Messages -->
  <div id="chatlogs" style="
    flex-grow: 1;
    padding: 20px;
    background: #3b3529;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 14px;
    font-size: 0.95rem;
  "></div>

  <!-- Input Area -->
  <div style="
    padding: 16px 20px;
    border-top: 1px solid #5a533d;
    display: flex;
    gap: 12px;
    background: #2d2a25;
  ">
    <input id="userInput" type="text" placeholder="Type your message..." autocomplete="off" style="
      flex-grow: 1;
      padding: 12px 18px;
      border: 2px solid #d1bc6f;
      border-radius: 30px;
      font-size: 1rem;
      color: #f1e6c9;
      background: #4a3a1e;
      outline: none;
      transition: border-color 0.3s, background-color 0.3s;
    " onfocus="this.style.background='#5a481d'" onblur="this.style.background='#4a3a1e'" />
    <button onclick="sendMessage()" style="
      background: #d1bc6f;
      border: none;
      border-radius: 30px;
      padding: 12px 26px;
      color: #4a3a1e;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s, color 0.3s;
      user-select: none;
    " onmouseover="this.style.background='#b89f3d'; this.style.color='#fff';" onmouseout="this.style.background='#d1bc6f'; this.style.color='#4a3a1e';">
      Send
    </button>
  </div>
</div>

<style>
  #chat-icon:hover {
    transform: scale(1.2);
    box-shadow: 0 8px 20px rgba(191,164,111,0.7);
    color: #fff;
  }
  /* ==============================
   CELEB APPROVED â€“ 4 x 2 FIX
   ============================== */

.celebapp {
    max-width: 1200px;
    margin: 60px auto;
}

.celebapp h1 {
    text-align: center;
    margin-bottom: 40px;
}

/* both rows same behavior */
.brands,
.brands2 {
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* ðŸ‘ˆ 4 images per row */
    gap: 30px;
    margin-bottom: 35px;
}

/* image styling */
.brands img,
.brands2 img {
    width: 100%;
    height: 140px;
    object-fit: contain;
    background: #fff;
    padding: 12px;
    border-radius: 14px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.08);
}

</style>
<script>
  function dragElement(elmnt) {
    var pos1=0, pos2=0, pos3=0, pos4=0;
    const header = document.getElementById(elmnt.id + "-header");
    if(header) {
      header.onmousedown = dragMouseDown;
    } else {
      elmnt.onmousedown = dragMouseDown;
    }
    function dragMouseDown(e) {
      e = e || window.event;
      e.preventDefault();
      pos3 = e.clientX;
      pos4 = e.clientY;
      document.onmouseup = closeDragElement;
      document.onmousemove = elementDrag;
    }
    function elementDrag(e) {
      e = e || window.event;
      e.preventDefault();
      pos1 = pos3 - e.clientX;
      pos2 = pos4 - e.clientY;
      pos3 = e.clientX;
      pos4 = e.clientY;
      elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
      elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
    }
    function closeDragElement() {
      document.onmouseup = null;
      document.onmousemove = null;
    }
  }
  document.addEventListener("DOMContentLoaded", () => {
    dragElement(document.getElementById("chat-popup"));
  });

  const chatIcon = document.getElementById('chat-icon');
  const chatPopup = document.getElementById('chat-popup');
  const closeChat = document.getElementById('close-chat');
  const chatlogs = document.getElementById('chatlogs');
  const userInput = document.getElementById('userInput');

  function showChat() {
    chatPopup.style.display = 'flex';
    chatIcon.style.display = 'none';
    userInput.focus();

    if(chatlogs.children.length === 0) {
      appendMessage('Bot', 'Namaste! Main aapki madad ke liye hoon. Aap apna sawal type karein.');
    }
    localStorage.setItem('chatOpen', 'true');
  }

  function hideChat() {
    chatPopup.style.display = 'none';
    chatIcon.style.display = 'flex';
    localStorage.setItem('chatOpen', 'false');
  }

  chatIcon.addEventListener('click', showChat);
  closeChat.addEventListener('click', hideChat);

  // Remove this whole block to prevent reopening chat on refresh
  
  // window.addEventListener('load', () => {
  //   // if(localStorage.getItem('chatOpen') === 'true') {
  //   //   showChat();
  //   // }
  // });
  

  function appendMessage(sender, message) {
    const msg = document.createElement('div');
    msg.style.padding = '10px 16px';
    msg.style.borderRadius = '20px';
    msg.style.maxWidth = '75%';
    msg.style.wordWrap = 'break-word';
    msg.style.color = sender === 'You' ? '#4a3a1e' : '#f1e6c9';
    msg.style.backgroundColor = sender === 'You' ? '#d1bc6f' : '#4a3a1e';
    msg.style.alignSelf = sender === 'You' ? 'flex-end' : 'flex-start';
    msg.style.fontWeight = 500;
    msg.style.marginBottom = '14px';
    msg.innerHTML = `<b>${sender}:</b> ${message}`;
    chatlogs.appendChild(msg);
    chatlogs.scrollTop = chatlogs.scrollHeight;
  }

  function sendMessage() {
    const message = userInput.value.trim();
    if(!message) return;
    appendMessage('You', message);
    userInput.value = '';
    userInput.disabled = true;

    fetch('/chatbot/api/', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({message}),
    })
    .then(res => res.json())
    .then(data => {
      if(data.error) {
        appendMessage('Bot', 'Error: ' + data.error);
      } else {
        appendMessage('Bot', data.response);
      }
      userInput.disabled = false;
      userInput.focus();
    })
    .catch(() => {
      appendMessage('Bot', 'Sorry, error occurred.');
      userInput.disabled = false;
      userInput.focus();
    });
  }

  userInput.addEventListener('keydown', e => {
    if(e.key === 'Enter') {
      sendMessage();
      e.preventDefault();
    }
  });
</script>



{% endblock %}